# DMPC Controller Workspace (Puzzlebot Deployment)

This workspace contains the DMPC node that must be executed **independently on each Puzzlebot**. The DMPC node handles decentralized trajectory tracking and collision avoidance based on references generated by the Virtual Structure system.

---

## Setup Before Running

### 1. Physical Robot Placement
Before running anything, place the robots on the testing area **from left to right**:

```
Puzzlebot 1 → Puzzlebot 2 → Puzzlebot 3 → Puzzlebot 4
```

The order matters because each robot uses a specific namespace and launch configuration.

---

## 2. Connect to Each Puzzlebot via SSH

All commands must be executed **from your computer**, connecting to each robot through SSH.

Use the IP written on the antenna of each Puzzlebot. Example:

```bash
ssh -X puzzlebot@10.15.232.xx
```

Do this in a different terminal for each Puzzlebot.

---

## 3. Ensure Topics Are Publishing (Puzzlebot 3 and Puzzlebot 4)

Puzzlebot 3 and Puzzlebot 4 require the micro-ROS agent to be running so their ROS 2 topics are published.

On Puzzlebot 3:

```bash
ssh -X puzzlebot@10.15.232.xx
ros2 launch puzzlebot_ros micro_agent.launch.py
```

On Puzzlebot 4:

```bash
ssh -X puzzlebot@10.15.232.xx
ros2 launch puzzlebot_ros micro_agent.launch.py
```

Leave these terminals open.

Puzzlebot 1 and Puzzlebot 2 do not need this step.

---

## Build the DMPC Workspace

On **each** Puzzlebot:

```bash
cd ~/puzzlebot_ws      # adjust if workspace name is different
colcon build
source install/setup.bash
```

Do this once per robot after uploading the workspace.

---

## Running the DMPC Node

Each Puzzlebot has its own launch file.  
After building and sourcing, run:

### Puzzlebot 1:
```bash
ros2 launch dmpc_controller puzzlebot1.launch.py
```

### Puzzlebot 2:
```bash
ros2 launch dmpc_controller puzzlebot2.launch.py
```

### Puzzlebot 3:
```bash
ros2 launch dmpc_controller puzzlebot3.launch.py
```

### Puzzlebot 4:
```bash
ros2 launch dmpc_controller puzzlebot4.launch.py
```

Each must be launched from the terminal connected to that specific robot via SSH.

---

## Notes

- Run each DMPC controller on **its own robot**, never on the main computer.
- Ensure Puzzlebot 3 and 4 are publishing topics before running their DMPC nodes.
- Launch order usually is:  
  1. Place robots  
  2. SSH into each Puzzlebot  
  3. Start micro-agent on PB3 and PB4  
  4. Build & source  
  5. Launch the corresponding DMPC launch file  
- The Virtual Structure node (from your laptop) should be started after all DMPC nodes are active.

